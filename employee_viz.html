<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Employee Department Distribution</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="author" content="24f1002855@ds.study.iitm.ac.in">
  <script src="https://cdn.plot.ly/plotly-2.29.1.min.js"></script>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial; margin: 24px; background:#fcfdff; color:#0b1220;}
    header { margin-bottom: 18px; }
    h1 { margin: 0; font-size: 1.6rem; color:#102a43; }
    .meta { color:#334e68; margin-top:6px; font-size:0.95rem; }
    .counts { background: #ffffff; border: 1px solid #e1e8f0; padding: 12px; border-radius: 8px; display:inline-block; margin-top:12px; }
    pre { margin:0; font-size:0.95rem; }
    #chart { width:512px; max-width:100%; height:420px; margin-top:18px; }
    footer { margin-top:22px; color:#475569; font-size:0.9rem; }
  </style>
</head>
<body>
  <header>
    <h1>Employee Department Distribution</h1>
    <div class="meta">Author / Verification: <strong>24f1002855@ds.study.iitm.ac.in</strong></div>
  </header>

  <section class="counts" id="counts-section" aria-live="polite">
    <strong>Department frequency counts (from provided dataset):</strong>
    <pre id="counts-text">Loading...</pre>
    <div style="height:8px"></div>
    <strong>Number of employees in Marketing:</strong> <span id="marketing-count">â€”</span>
  </section>

  <div id="chart" role="img" aria-label="Bar chart showing number of employees per department"></div>

  <footer>
    <p>Dataset: 5 rows sample provided inline. Script computes counts client-side in this HTML file.</p>
  </footer>

<script>
/*
 This HTML is self-contained and computes the counts from the CSV sample provided.
 It then renders an interactive Plotly bar chart and writes the counts into the page.
*/

// === 1) Raw CSV text (use the exact dataset you provided) ===
const csvText = `employee_id,department,region,performance_score,years_experience,satisfaction_rating
EMP001,IT,Asia Pacific,72.35,5,4
EMP002,Operations,Latin America,61.17,5,4.6
EMP003,Operations,Latin America,65.23,10,4.4
EMP004,R&D,Europe,86.15,9,3.5
EMP005,R&D,Africa,90.36,2,4`;

// === 2) Parse CSV (simple parser for this dataset) ===
function parseCSV(text) {
  const lines = text.trim().split(/\r?\n/);
  const header = lines[0].split(',').map(h => h.trim());
  const rows = lines.slice(1).map(line => {
    // handle simple commas; fields do not contain commas in the sample
    const vals = line.split(',').map(v => v.trim());
    const obj = {};
    header.forEach((h, i) => obj[h] = vals[i]);
    return obj;
  });
  return { header, rows };
}

const parsed = parseCSV(csvText);

// === 3) Compute department frequencies ===
const deptCounts = {};
parsed.rows.forEach(r => {
  const d = r['department'] || 'Unknown';
  deptCounts[d] = (deptCounts[d] || 0) + 1;
});

// Ensure "Marketing" key exists for display (even if zero)
if (!deptCounts.hasOwnProperty('Marketing')) deptCounts['Marketing'] = 0;

// Sort departments by count descending for nicer chart ordering
const sorted = Object.entries(deptCounts).sort((a,b) => b[1] - a[1]);
const departments = sorted.map(e => e[0]);
const counts = sorted.map(e => e[1]);

// === 4) Fill counts into page text ===
const countsLines = sorted.map(([dept, cnt]) => `${dept}: ${cnt}`).join('\n');
document.getElementById('counts-text').textContent = countsLines;
document.getElementById('marketing-count').textContent = deptCounts['Marketing'];

// === 5) Create Plotly bar chart ===
const data = [{
  x: departments,
  y: counts,
  type: 'bar',
  marker: {
    color: departments.map(d => {
      // simple professional palette: R&D -> blue, Operations -> teal, IT -> indigo, others -> gray
      if (d === 'R&D') return '#2563eb';
      if (d === 'Operations') return '#0ea5a4';
      if (d === 'IT') return '#7c3aed';
      if (d === 'Marketing') return '#ef4444';
      return '#64748b';
    }),
    line: { color: '#ffffff', width: 1 }
  },
  text: counts.map(String),
  textposition: 'outside',
  hovertemplate: '%{x}: %{y}<extra></extra>'
}];

const layout = {
  title: {
    text: 'Employee Count by Department (sample)',
    font: { size: 16 }
  },
  xaxis: { title: 'Department', automargin: true },
  yaxis: { title: 'Number of Employees', dtick: 1, rangemode: 'tozero' },
  margin: { t:50, b:140, l:60, r:30 },
  plot_bgcolor: '#ffffff',
  paper_bgcolor: '#fcfdff',
  showlegend: false
};

const config = { responsive: true, displayModeBar: false };

Plotly.newPlot('chart', data, layout, config);

</script>
</body>
</html>
